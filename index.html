<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pronósticos de Fútbol</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;}
        .container {max-width:1200px;margin:0 auto;}
        h1 {color:white;text-align:center;font-size:2.5rem;margin:40px 0;text-shadow:2px 2px 4px rgba(0,0,0,0.3);}
        .card {background:white;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin:20px 0;}
        .card h2 {color:#667eea;margin-bottom:20px;font-size:1.8rem;}
        .control-panel {display:flex;gap:15px;align-items:center;flex-wrap:wrap;padding:25px;background:#f8f9fa;border-radius:10px;}
        button {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:12px 30px;border-radius:10px;font-size:1rem;font-weight:bold;cursor:pointer;transition:all 0.3s;}
        button:hover {transform:translateY(-2px);box-shadow:0 8px 20px rgba(102,126,234,0.4);}
        button:disabled {background:#ccc;cursor:not-allowed;transform:none;}
        #league-selector {padding:12px 20px;border:2px solid #667eea;border-radius:10px;font-size:1rem;background:white;cursor:pointer;font-weight:600;}
        .match-card {background:white;border:2px solid #e0e0e0;border-radius:15px;padding:25px;margin:20px 0;transition:all 0.3s;}
        .match-card:hover {transform:translateY(-5px);box-shadow:0 8px 25px rgba(0,0,0,0.15);border-color:#667eea;}
        .match-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #f0f0f0;}
        .league-badge {background:#667eea;color:white;padding:8px 16px;border-radius:20px;font-weight:bold;font-size:0.9rem;}
        .team-names {display:flex;justify-content:space-between;align-items:center;margin:25px 0;}
        .team-logo {width:70px;height:70px;object-fit:contain;}
        .match-info {display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;padding:15px;background:#f8f9fa;border-radius:10px;margin:20px 0;font-size:0.9rem;color:#666;}
        .loading {text-align:center;padding:60px 20px;color:#667eea;font-size:1.5rem;font-weight:bold;}
        .loading::after {content:'...';animation:dots 1.5s steps(4,end) infinite;}
        @keyframes dots {0%,20%{content:'.';}40%{content:'..';}60%,100%{content:'...';}}
        .error-message {background:#f8d7da;color:#721c24;padding:20px;border-radius:10px;border-left:5px solid #dc3545;margin:15px 0;}
        .success-message {background:#d4edda;color:#155724;padding:20px;border-radius:10px;border-left:5px solid #28a745;margin:15px 0;}
        .prediction-card {background:white;border:2px solid #e0e0e0;border-radius:10px;padding:20px;margin:15px 0;display:flex;justify-content:space-between;align-items:center;}
        .prediction-badge {padding:8px 16px;border-radius:20px;font-weight:bold;color:white;}
        .badge-1 {background:#28a745;}
        .badge-x {background:#ffc107;color:#333;}
        .badge-2 {background:#dc3545;}
        @media (max-width:768px) {h1{font-size:2rem;}.control-panel{flex-direction:column;}.team-names{flex-direction:column;gap:20px;}}
    </style>
</head>
<body>
<div class="container">
    <h1>⚽ Pronósticos de Fútbol</h1>
    <div class="card">
        <div class="control-panel">
            <button onclick="probarConexion()">🔌 Test API</button>
            <select id="league-selector">
                <option value="140">🇪🇸 La Liga</option>
                <option value="39">🏴 Premier League</option>
                <option value="135">🇮🇹 Serie A</option>
                <option value="78">🇩🇪 Bundesliga</option>
                <option value="61">🇫🇷 Ligue 1</option>
                <option value="239">🇨🇴 Liga Colombiana</option>
            </select>
            <button onclick="cargarPartidos()">📊 Cargar Partidos</button>
            <button onclick="limpiarPronosticos()" style="background:#dc3545;">🗑️ Limpiar</button>
        </div>
    </div>
    <div class="card">
        <h2>📅 Próximos Partidos</h2>
        <div id="matches-container">
            <p style="text-align:center;color:#666;padding:40px;">
                Haz clic en "Cargar Partidos" para ver los próximos encuentros
            </p>
        </div>
    </div>
    <div class="card">
        <h2>🎯 Mis Pronósticos</h2>
        <div id="predictions-container">
            <p style="text-align:center;color:#666;padding:20px;">
                No hay pronósticos guardados
            </p>
        </div>
    </div>
</div>
<script>
const API_KEY = 'TU_API_KEY_AQUI'; // Pega aquí tu API Key de API-Sports
const CONFIG = {
    apiUrl: 'https://v3.football.api-sports.io',
    currentSeason: 2024
};
const headers = {'x-apisports-key':API_KEY};

async function probarConexion() {
    const btn = event.target;
    btn.disabled = true; btn.textContent = '⏳ Conectando...';
    try {
        const response = await fetch(`${CONFIG.apiUrl}/status`, {headers});
        const data = await response.json();
        if (data.response) {
            const info = data.response.requests;
            mostrarMensaje('success', `✅ Conexión OK! Requests: ${info.current}/${info.limit_day}`);
            btn.textContent = '✅ Conectado';
        }
    } catch (error) {
        mostrarMensaje('error', '❌ Error de conexión. Verifica tu API Key');
        btn.textContent = '🔌 Test API'; btn.disabled = false;
    }
}

async function cargarPartidos() {
    const selector = document.getElementById('league-selector');
    const leagueId = parseInt(selector.value);
    const container = document.getElementById('matches-container');
    container.innerHTML = '<div class="loading">Cargando partidos</div>';
    try {
        const response = await fetch(
            `${CONFIG.apiUrl}/fixtures?league=${leagueId}&season=${CONFIG.currentSeason}&next=15`,
            {headers}
        );
        if (!response.ok) throw new Error(`Error HTTP ${response.status}`);
        const data = await response.json();
        if (data.response && data.response.length > 0) mostrarPartidos(data.response);
        else container.innerHTML = '<p class="error-message">⚠️ No hay partidos próximos para esta liga</p>';
    } catch (error) {
        container.innerHTML = `<div class="error-message"><strong>❌ Error:</strong> ${error.message}<br><br>Verifica que tu API Key esté correctamente configurada</div>`;
        console.error('Error completo:', error);
    }
}

function mostrarPartidos(partidos) {
    const container = document.getElementById('matches-container');
    container.innerHTML = '';
    partidos.forEach(p => {
        const fecha = new Date(p.fixture.date);
        const fechaStr = fecha.toLocaleDateString('es-ES',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
        const horaStr = fecha.toLocaleTimeString('es-ES',{hour:'2-digit',minute:'2-digit'});
        const card = document.createElement('div');
        card.className = 'match-card';
        card.innerHTML = `
            <div class="match-header">
                <span class="league-badge">${p.league.name}</span>
                <span>${fechaStr}</span>
            </div>
            <div class="team-names">
                <div style="text-align: center; flex: 1;">
                    <img src="${p.teams.home.logo}" class="team-logo">
                    <div style="margin-top: 10px; font-weight: bold; font-size: 1.1rem;">${p.teams.home.name}</div>
                </div>
                <div style="text-align: center; padding: 0 30px;">
                    <div style="font-size: 2.5rem; color: #999; font-weight: bold;">VS</div>
                    <div style="color:#667eea;margin-top:10px;font-weight:bold;">⏰ ${horaStr}</div>
                </div>
                <div style="text-align: center; flex: 1;">
                    <img src="${p.teams.away.logo}" class="team-logo">
                    <div style="margin-top:10px;font-weight:bold;font-size:1.1rem;">${p.teams.away.name}</div>
                </div>
            </div>
            <div class="match-info">
                <div>🏟️ ${p.fixture.venue.name||'Por confirmar'}</div>
                <div>📍 ${p.fixture.venue.city||'-'}</div>
                <div>👤 ${p.fixture.referee||'Por confirmar'}</div>
            </div>
            <button onclick="hacerPronostico(${p.fixture.id},'${p.teams.home.name.replace(/'/g,"\\'")}','${p.teams.away.name.replace(/'/g,"\\'")}','${p.teams.home.logo}','${p.teams.away.logo}')" style="width:100%;margin-top:15px;">🎯 Hacer Pronóstico</button>
        `;
        container.appendChild(card);
    });
    const contador = document.createElement('p');
    contador.style.cssText = 'text-align:center;margin:30px 0;color:#666;font-weight:bold;font-size:1.1rem;';
    contador.textContent = `📊 Mostrando ${partidos.length} partidos próximos`;
    container.appendChild(contador);
}

function hacerPronostico(id, home, away, homeLogo, awayLogo) {
    const modal = document.createElement('div');
    modal.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;justify-content:center;align-items:center;z-index:10000;padding:20px;';
    modal.innerHTML = `
        <div style="background:white;padding:50px;border-radius:20px;max-width:600px;width:100%;text-align:center;">
            <h2 style="margin-bottom:40px;color:#667eea;font-size:2rem;">🎯 Hacer Pronóstico</h2>
            <div style="display:flex;justify-content:space-around;align-items:center;margin-bottom:40px;">
                <div style="flex:1;">
                    <img src="${homeLogo}" style="width:80px;height:80px;object-fit:contain;">
                    <p style="margin-top:15px;font-weight:bold;font-size:1.1rem;">${home}</p>
                </div>
                <div style="font-size:2.5rem;color:#999;font-weight:bold;padding:0 30px;">VS</div>
                <div style="flex:1;">
                    <img src="${awayLogo}" style="width:80px;height:80px;object-fit:contain;">
                    <p style="margin-top:15px;font-weight:bold;font-size:1.1rem;">${away}</p>
                </div>
            </div>
            <p style="margin-bottom:30px;color:#666;font-size:1.1rem;">Selecciona tu pronóstico:</p>
            <div style="display:flex;gap:15px;justify-content:center;margin-bottom:30px;">
                <button onclick="guardarPronostico(${id},'1','${home.replace(/'/g,"\\'")}','${away.replace(/'/g,"\\'")}','${homeLogo}','${awayLogo}')" style="flex:1;padding:25px;background:#28a745;color:white;border:none;border-radius:12px;cursor:pointer;font-weight:bold;font-size:1.2rem;">
                    1<br><small style="font-size:0.8rem;">Victoria Local</small>
                </button>
                <button onclick="guardarPronostico(${id},'X','${home.replace(/'/g,"\\'")}','${away.replace(/'/g,"\\'")}','${homeLogo}','${awayLogo}')" style="flex:1;padding:25px;background:#ffc107;color:#333;border:none;border-radius:12px;cursor:pointer;font-weight:bold;font-size:1.2rem;">
                    X<br><small style="font-size:0.8rem;">Empate</small>
                </button>
                <button onclick="guardarPronostico(${id},'2','${home.replace(/'/g,"\\'")}','${away.replace(/'/g,"\\'")}','${homeLogo}','${awayLogo}')" style="flex:1;padding:25px;background:#dc3545;color:white;border:none;border-radius:12px;cursor:pointer;font-weight:bold;font-size:1.2rem;">
                    2<br><small style="font-size:0.8rem;">Victoria Visitante</small>
                </button>
            </div>
            <button onclick="this.closest('div').parentElement.remove()" style="padding:15px 40px;background:#6c757d;color:white;border:none;border-radius:10px;cursor:pointer;font-size:1rem;font-weight:bold;">Cancelar</button>
        </div>
    `;
    document.body.appendChild(modal);
    modal.onclick = e => { if (e.target === modal) modal.remove(); };
}

function guardarPronostico(id, pred, home, away, homeLogo, awayLogo) {
    const pronosticos = JSON.parse(localStorage.getItem('pronosticos') || '[]');
    pronosticos.push({id,fecha:new Date().toISOString(),homeTeam:home,awayTeam:away,homeLogo,awayLogo,prediccion:pred});
    localStorage.setItem('pronosticos', JSON.stringify(pronosticos));
    document.querySelectorAll('div').forEach(div=>{if(div.style.zIndex==='10000')div.remove();});
    mostrarMensaje('success','✅ Pronóstico guardado correctamente');
    cargarPronosticosGuardados();
}

function cargarPronosticosGuardados() {
    const container = document.getElementById('predictions-container');
    const pronosticos = JSON.parse(localStorage.getItem('pronosticos') || '[]');
    if(pronosticos.length===0){
        container.innerHTML='<p style="text-align:center;color:#666;padding:20px;">No hay pronósticos guardados aún</p>';return;}
    container.innerHTML=`<h3 style="margin-bottom:20px;color:#667eea;">Total de pronósticos: ${pronosticos.length}</h3>`;
    pronosticos.reverse().slice(0,20).forEach(p=>{
        const div=document.createElement('div');
        div.className='prediction-card';
        const badgeClass=p.prediccion==='1'?'badge-1':p.prediccion==='X'?'badge-x':'badge-2';
        div.innerHTML=`
            <div style="display:flex;align-items:center;gap:15px;flex:1;">
                <img src="${p.homeLogo}" style="width:40px;height:40px;object-fit:contain;">
                <div style="flex:1;">
                    <strong>${p.homeTeam} vs ${p.awayTeam}</strong><br>
                    <small style="color:#666;">${new Date(p.fecha).toLocaleString('es-ES')}</small>
                </div>
                <img src="${p.awayLogo}" style="width:40px;height:40px;object-fit:contain;">
            </div>
            <span class="prediction-badge ${badgeClass}">Predicción: ${p.prediccion}</span>
        `;
        container.appendChild(div);
    });
}
function limpiarPronosticos(){
    if(confirm('¿Estás seguro de que quieres eliminar todos los pronósticos guardados?')){
        localStorage.removeItem('pronosticos');
        cargarPronosticosGuardados();
        mostrarMensaje('success','🗑️ Historial de pronósticos eliminado');
    }
}
function mostrarMensaje(tipo,mensaje){
    const div=document.createElement('div');
    div.className=tipo==='success'?'success-message':'error-message';
    div.textContent=mensaje;
    div.style.cssText='position:fixed;top:20px;right:20px;z-index:10001;max-width:400px;';
    document.body.appendChild(div);setTimeout(()=>div.remove(),4000);
}
window.onload=()=>{console.log('✅ App cargada');cargarPronosticosGuardados();};
</script>
</body>
</html>
